# Техническое задание (ТЗ)

---

## 1. Цели и задачи

### 1.1 Цель

Создать минимальный вариант системы управления пользователями и ролями — ядро будущей системы авторизации.
MVP должен позволять:

- регистрировать и управлять пользователями;
- начать им роли и управлять этими ролями;
- доставлять REST API через административный интерфейс (admin-api).

### 1.2 Задачи

1. Реализовать user-service — управление пользователями.
2. Реализовать role-service — управление ролями и назначениями ролей пользователям.
3. Реализовать admin-api (FastAPI) — REST API для администрирования пользователей и ролей.
4. Организовать взаимодействие между сервисами через внутренние события (in-memory event bus).
5. Обеспечить модульность и масштабируемость архитектуры для дальнейшего добавления client-service и auth-service.

---

## 2 Назначение проекта

Система предназначена для:

- администраторов, управляющих пользователями и ролями;
- будущего расширения под полноценную систему авторизации (OAuth2, OpenID Connect);
- демонстрации умения строить архитектуру микросервисного приложения по DDD.

---

## 3 Функциональные требования

### 3.1 Управление пользователями (user-service)

- Создание пользователя — email, username, пароль.
- Просмотр пользователя по ID.
- Обновление (email, пароль, статус).
- Удаление пользователя.
- Активация/деактивация.

События:

- UserCreated
- UserUpdated
- UserDeleted

### 3.2 Управление ролями (role-service)

- Создание роли (имя, описание).
- Просмотр списка ролей.
- Удаление роли.
- Назначение/удаление роли пользователю.

События:

- RoleAssigned
- RoleRemoved

### 3.3 Административный API (admin-api)

- REST API для управления пользователями и ролями.
- Авторизация через JWT (администратор).
- Swagger-документация.
- Обработка событий от user-service и role-service (через общий event bus).

---

## 4. Нефункциональные требования

| категория      | Требование                                           |
|----------------|------------------------------------------------------|
| Архитектура    | DDD, монорепозиторий, изолированные bounded contexts |
| Языки          | Go, Python                                           |
| БД             | PostgreSQL, Redis                                    |
| Взаимодействие | REST, gRPC между сервисам                            |
| События        | Событийная модель при помощи Kafka                   |
| Безопасность   | JWT для админ-доступа                                |
| Документация   | Swagger/OpenAPI                                      |
| Разворачивание | Docker Compose, Kubernetes                           |
| Тесты          | Unit-тесты для доменного и аппликационного слоёв     |                                                     |                                                      |

---

## 5. Ограничения и допущения

- Проект выполняется в одного разработчика, поэтому фокус — на качестве архитектуры, а не на полном функционале.
- UI минимальный или шаблонный по возможности.
- Валидация и безопасность — на базовом уровне.
- In-memory event bus, легко заменяемый на Kafka позже.
- Производительность не критична.
- В дальнейшем можно безболезненно добавить client-service и auth-service.

---

## 6. Критерии успеха

| Критерий                | Условие                                                  |
|-------------------------|----------------------------------------------------------|
| API работает            | CRUD для пользователей и ролей                           |
| DDD соблюдён            | domain, application, infrastructure уровни разделены     |
| События функционируют   | события генерируются и обрабатываются                    |
| Admin API интегрировано | админ может управлять пользователями и ролями через REST |
| Документация            | Swagger и README                                         |
| Разворачивание          | docker-compose up запускает всё окружение                |

---

## 7. Минимальный технологический стек

| Компонент       | Технология            |
|-----------------|-----------------------|
| Backend сервисы | Go 1.23+              |
| Admin API       | Python 3.11 + FastAPI |
| Базы данных     | PostgreSQL            |
| События         | internal event bus    |
| Документация    | Swagger               |
| Сборка          | Docker Compose        |
| Логирование     | Zerolog / Logrus      |
| Тестирование    | Go test, Pytest       |

---

## 8. План реализации

### 8.1 MVP

---

## 9. Финальный результат

- Рабочий проект с изолированными сервисами (user-service, role-service, admin-api).
- Событийное взаимодействие через in-memory event bus.
- Swagger-документация для всех API.
- Docker-compose окружение для разворачивания.
- README с архитектурной схемой и инструкцией по запуску.

---